\documentclass[journal]{IEEEtran}
\usepackage[a5paper, margin=10mm]{geometry}
%\usepackage{lmodern} % Ensure lmodern is loaded for pdflatex
\usepackage{tfrupee} % Include tfrupee package

%iffalse
\let\negmedspace\undefined
\let\negthickspace\undefined
\usepackage{gvv-book}
\usepackage{gvv}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts,amsthm}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{txfonts}
\usepackage{listings}
\usepackage{enumitem}
\usepackage{mathtools}
\usepackage{gensymb}
\usepackage{comment}
\usepackage[breaklinks=true]{hyperref}
\usepackage{tkz-euclide} 
\usepackage{listings}                                        
%\def\inputGnumericTable{}                                 
\usepackage[latin1]{inputenc}                                
\usepackage{color}                                            
\usepackage{array}                                            
\usepackage{longtable}                                       
\usepackage{calc}                                             
\usepackage{multirow}                                         
\usepackage{hhline}                                           
\usepackage{ifthen}                                           
\usepackage{lscape}
\usepackage{tabularx}
\usepackage{array}
\usepackage{float}
\usepackage{multicol}

\newcommand{\BEQA}{\begin{eqnarray}}
\newcommand{\EEQA}{\end{eqnarray}}
%\newcommand{\define}{\stackrel{\triangle}{=}}

\setlength{\headheight}{1cm} % Set the height of the header box
\setlength{\headsep}{0mm}     % Set the distance between the header box and the top of the text

%\usepackage[a5paper, top=10mm, bottom=10mm, left=10mm, right=10mm]{geometry}


\setlength{\intextsep}{10pt} % Space between text and floats

% Marks the beginning of the document
\begin{document}
\onecolumn
\bibliographystyle{IEEEtran}
\vspace{3cm}

%\renewcommand{\theequation}{\theenumi}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
% \renewcommand{\thefigure}{\theenumi}
\renewcommand{\thetable}{\theenumi}

\title{Affine Transformations}
\author{EE24BTECH11059 -  Y SIDDHANTH}
\maketitle

% \renewcommand{\thefigure}{\theenumi}
\renewcommand{\thetable}{\theenumi} 

\setcounter{section}{1}
\textbf{Question: } Plot the ellipse whose focus is $\myvec{1 \\ -1}$, directrix $x-y-3 = 0$, and $e = \frac{1}{2}$. Plot the corresponding standard ellipse in the same graph using Affine Transformation.

\bigskip

\textbf{Solution: } 
\begin{table}[h!]    
	\centering
	\input{tables/table1.tex}
	\caption{Variables Used}
	\label{tab1-1.9-6}
\end{table}\\

First we find the second order equation of the actual ellipse using the eccentricity definition.\\
Let \(P\myvec{x\\y}\) be any point on the ellipse and PM be the perpendicular from P on the directrix. Then,
\begin{align}
	FP &= e \times PM\\
	FP &= \frac{1}{2} \times PM\\
	2FP &= PM\\
	4(FP)^2 &= PM^2\\
	4\sbrak{\brak{x+1}^2 + \brak{y-1}^2} &= \brak{\frac{x - y + 3}{\sqrt{1^2 + (-1)^2}}}^2\\
	4\sbrak{\brak{x+1}^2 + \brak{y-1}^2}  &= \brak{\frac{x - y + 3}{\sqrt{2}}}^2
\end{align}
Upon simplification, we get the second order two variable conic equation to be,
\begin{align}
	\frac{7}{4}\brak{x^2+y^2} + \frac{1}{2}xy + \frac{5}{2}\brak{-x+y} + \frac{7}{4} = 0 \label{acconiceq}
\end{align}
Comparing \eqref{acconiceq} with $x^\top\vec{V}x + 2\vec{u}^\top x + f = 0$, we get:
\begin{align}
	\vec{V} &= \myvec{\frac{7}{4} & \frac{1}{4} \\ \frac{1}{4} & \frac{7}{4}} ,
	\\
	\vec{u} &=\frac{5}{4}  \myvec{ -1 \\ 1}
	\\
	f &= \frac{7}{4}
\end{align}

For Affine Transformation, we have to spectral / eigen decompose the matrix $\vec{V}$. \\ 

\begin{align}
	\vec{V} = \vec{P}\vec{D}\vec{P^\top}
\end{align}
To find $\vec{D}$, we will have to find the eigen values of the matrix $\vec{V}$.

	\begin{align}
		|\vec{V}  - \lambda\vec{I}|  &= 0,\\
		|\vec{V}  - \lambda\vec{I}|  &= \mydet{\frac{7}{4} - \lambda& \frac{1}{4}\\ \frac{1}{4} & \frac{7}{4} - \lambda}\\
		\lambda_1, \lambda_2 &= \frac{3}{2} , 2\\
		\therefore 	\vec{D} &= \myvec{\frac{3}{2} & 0 \\ 0 & 2	} , \label{Ddef}
	\end{align}
Note: In \eqref{Ddef}, the order of the eigen values that I have chosen is from smallest to biggest due to eccentricity calculation.\\
\\
Now, to find $\vec{P}$ which is the matrix containing the normalized eigen vectors. So we have to find the eigen-values.



\begin{align}
	\vec{V}\vec{p_1^\prime} &= \lambda_1 \vec{p_1^\prime} \\
	\myvec{\frac{7}{4} & \frac{1}{4} \\ \frac{1}{4} & \frac{7}{4}} \vec{p_1^\prime}  &= \frac{3}{2}\vec{p_1^\prime} \\
\end{align}
Taking an augmented matrix,
\begin{align}
	\brak{
	\begin{array}{cc|c}
		\frac{7}{4} - \lambda_1 & \frac{1}{4} & 0\\ 
		\frac{1}{4} & \frac{7}{4} - \lambda_1& 0
	\end{array}}\vec{p_1^\prime}  &=  \myvec{0 \\ 0} 
\end{align}
\begin{align}
	\brak{
	\begin{array}{cc|c}
		\frac{1}{4} & \frac{1}{4} & \frac{3}{2}\\ 
		\frac{1}{4} & \frac{1}{4} & \frac{3}{2}
	\end{array}}
	\xleftrightarrow[]{R_1 \leftarrow {4 R_1}}
	\xleftrightarrow[]{R_2 \leftarrow {R_2-\frac{1}{4}R_1}}
	\brak{
	\begin{array}{cc|c}
		1 & 1 & 0\\ 
		0 & 0 & 0
		\end{array}}
\end{align}
If we take $\vec{p_1^\prime}  = \myvec{p_{11}^\prime \\ p_{12}^\prime}$, and put in the above equation, we get,
\begin{align}
	\vec{p_1^\prime} = p_{11}^\prime \myvec{-1 \\ 1} \implies \vec{p_1^\prime} =  \myvec{-1 \\ 1}
\end{align}
$\therefore \vec{p_1^\prime}  = \myvec{-1 \\ 1} \implies \vec{p_1} = \frac{\vec{p_1^\prime} }{\norm{\vec{p_1^\prime}}}  = \myvec{ -\frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}}}$ \\
Similarly solving for $\vec{p_2^\prime}$ , we get,

\begin{align}
	\vec{p_2^\prime} &=  \myvec{1 \\ 1} \\
\end{align} 
$\therefore \vec{p_2^\prime}  = \myvec{1 \\ 1} \implies \vec{p_2} = \frac{\vec{p_2^\prime} }{\norm{\vec{p_2^\prime}}}  = \myvec{ \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}}}$ \\
By definition $\vec{P} = \sbrak{\vec{p_1} ~ \vec{p_2}}$ \\ 

\begin{align}
	\vec{P} = \myvec{ - \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} } \label{Rdef}
\end{align}
By comparing $\vec{P}$ with a standard rotation matrix, $\myvec{\cos\theta & -\sin\theta \\ \sin\theta & \cos\theta}$
the angle of rotation of $\vec{P}$ is $\arccos\brak{- \frac{1}{\sqrt{2}}}$ or $\frac{3\pi}{4}$. \\\\
Now, we will use Affine Transformations to get the standard ellipse equation.

\begin{align}
	\vec{y}^\text{T}\brak{\frac{\vec{D}}{f_0}}\vec{y} &= 1\\
	\vec{x} &= \vec{Py} + \vec{c} \label{t1}\\
\end{align}

Where 

\begin{align}
	f_0 &= \vec{u}^\text{T}\vec{V}^{-1}\vec{u} - f  = \frac{25}{4} \myvec{-1 & 1} \myvec{\frac{7}{12} & \frac{-1}{12} \\ \frac{-1}{12} & \frac{7}{12}}  \myvec{-1 \\ 1}  - \frac{7}{4}= \frac{25}{12} -  \frac{7}{4} = \frac{1}{3}\\
	\vec{c} &= -\vec{V}^{-1}\vec{u} = -\frac{5}{4}  \myvec{-1 & 1} \myvec{\frac{7}{12} & \frac{-1}{12} \\ \frac{-1}{12} & \frac{7}{12}}\myvec{ -1 \\ 1} = \frac{5}{6}  \myvec{ 1 \\ -1}
\end{align}

Finally, we get the standard form of the ellipse.

\begin{align}
		\vec{y}^\text{T}\myvec{\frac{3}{2} & 0 \\ 0 & 2}\vec{y} &= \frac{1}{3}
\end{align}
Plotting the standard and the actual ellipse using python,

\begin{figure}[H]
	\centering
	\includegraphics[width=0.8\columnwidth]{Figures/fig1.png} 
	\caption{}
	\label{fig1}
\end{figure} 
To find the lengths of the semi-major and semi-minor axis, 
\begin{align}
	a &= \sqrt{\brak{\frac{f_0}{\lambda_1}}} =  \sqrt{\frac{2}{9}}\\
	b &= \sqrt{\brak{\frac{f_0}{\lambda_2}}} = \sqrt{\frac{1}{6}}
\end{align}
Equations of the minor and major axis of the actual ellispe can be found with $p_i(x - c) = 0$, $i = 1, 2$ respectively \\ 
\begin{align}
	\text{Minor Axis} \equiv   \myvec{- \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}}x = 0\\
	\text{Major Axis} \equiv   \myvec{\frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}}}x = 0
\end{align}
The Latus rectum of the ellipse can be found with,
\begin{align}
	l = 2\frac{\sqrt{|f_0 \lambda_1|}}{\lambda_2} = \frac{1}{\sqrt{2}}
\end{align}
Code for Figure \ref{fig1} can be found at:
\begin{lstlisting}
codes/misc.py
\end{lstlisting}
\end{document}